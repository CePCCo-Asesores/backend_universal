# Contrato del módulo NEUROPLAN_360
# Secciones evaluadas por Services\ContractValidator + Services\ContractGuard

pre:
  # Debe existir payload
  - path: "."
    op: required
    message: "payload requerido"

  # Acción válida
  - path: "action"
    op: in
    value: ["start", "step", "generate", "direct"]
    message: "action inválida (start|step|generate|direct)"

  # NOTA: Reglas condicionales (p.ej. step/session_id solo cuando action=step)
  # no se expresan aquí para no bloquear otras rutas. Validamos dentro del módulo.

post:
  # La respuesta debe existir y tener ok=true
  - path: "."
    op: required
    message: "respuesta requerida"

  - path: "ok"
    op: eq
    value: true
    message: "respuesta debe tener ok=true"

invariants:
  # Invariante mínima: respuesta/estado no vacío
  - path: "."
    op: required
